<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Provider Profile</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* Modern admin header and menu styles from admin.html */
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');
    body {
      font-family: 'Poppins', Arial, sans-serif;
      background: #f0f2f5;
      margin: 0;
      padding: 0;
    }
    header {
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      background: url('images/lights-sounds.png') center/cover no-repeat, rgba(255,255,255,0.7);
      background-blend-mode: lighten;
      border-bottom: 1px solid #ddd;
      box-shadow: 0 2px 12px rgba(0,0,0,0.07);
      backdrop-filter: blur(8px);
    }
    .logo-container img {
      height: 120px;
      cursor: pointer;
    }
    .logo-container a {
      display: inline-block;
    }
    .header-center {
      text-align: center;
      flex: 1;
    }
    .header-center h1 {
      font-size: 64px;
      font-weight: bold;
      color: #0047AB;
      text-shadow: 2px 2px #ffffff;
    }
    .header-center p {
      font-size: 24px;
      color: #0047AB;
      text-shadow: 1px 1px #ffffff;
    }
    .header-icons {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    .header-icons i {
      font-size: 28px;
      color: #000;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .header-icons i:hover {
      transform: scale(1.2);
    }
    .menu-popup {
      display: none;
      position: fixed;
      top: 80px;
      right: 20px;
      background-color: #fff;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      border-radius: 10px;
      overflow: hidden;
      z-index: 1000;
      min-width: 200px;
      transition: all 0.3s ease;
    }
    .menu-popup a {
      display: block;
      padding: 10px 15px;
      color: #000;
      text-decoration: none;
      border-bottom: 1px solid #eee;
    }
    .menu-popup a:hover {
      background-color: #f0f0f0;
    }
    .menu-popup a:last-child {
      background-color: #191970;
      color: #fff;
      border-bottom: none;
      transition: background 0.3s ease, transform 0.2s;
    }
    .menu-popup a:last-child:hover {
      background-color: #000080;
      transform: scale(1.02);
    }
    .container {
      max-width: 900px;
      margin: 40px auto;
      padding: 20px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    h2 {
      color: #0047AB;
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }

    input, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 16px;
    }

    .section {
      margin-bottom: 30px;
    }

    button {
      margin-top: 15px;
      padding: 12px 20px;
      background: #0047AB;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
    }

    .success {
      color: green;
      font-weight: bold;
      margin-top: 10px;
    }

    footer {
      background-color: #000;
      color: white;
      text-align: center;
      padding: 15px 10px;
      margin-top: 40px;
    }
    /* Modern card and table polish */
    .card {
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.13);
      padding: 32px 28px 28px 28px;
      margin-bottom: 32px;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }
    .card h3 {
      font-size: 1.4rem;
      font-weight: 700;
      color: #0047AB;
      margin-bottom: 18px;
      letter-spacing: 1px;
    }
    .card label {
      font-weight: 600;
      margin-top: 12px;
      margin-bottom: 4px;
      color: #1e5aa8;
    }
    .card input, .card textarea, .card select {
      width: 100%;
      padding: 12px 14px;
      border: 1px solid #bccedf;
      border-radius: 8px;
      font-size: 1rem;
      margin-bottom: 12px;
      margin-top: 2px;
      background: #f8fafc;
      transition: border 0.2s;
    }
    .card input:focus, .card textarea:focus {
      border: 1.5px solid #0047AB;
      outline: none;
      background: #eaf1fb;
    }
    .card button {
      background: #0047AB;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 12px 28px;
      font-size: 1rem;
      font-weight: 600;
      margin-top: 8px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: background 0.2s, transform 0.2s;
      box-shadow: 0 2px 8px rgba(30,90,168,0.08);
    }
    .card button:hover {
      background: #191970;
      transform: translateY(-2px) scale(1.03);
    }
    .success {
      color: #1e7e34;
      font-weight: 600;
      margin-top: 10px;
      margin-bottom: 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      background: #f9f9fb;
      border-radius: 10px;
      overflow: hidden;
    }
    th, td {
      padding: 12px 10px;
      text-align: left;
    }
    th {
      background: #eaf1fb;
      color: #0047AB;
      font-weight: 700;
      border-bottom: 2px solid #bccedf;
    }
    tr:nth-child(even) {
      background: #f4f7fa;
    }
    tr:hover {
      background: #e0eaff;
    }
    td button {
      margin-right: 6px;
      padding: 7px 16px;
      font-size: 0.95rem;
      border-radius: 6px;
    }
    @media (max-width: 900px) {
      .container {
        max-width: 98vw;
        padding: 0;
      }
      .card {
        max-width: 98vw;
        padding: 18px 2vw 18px 2vw;
      }
      table {
        font-size: 0.98rem;
      }
    }
    @media (max-width: 700px) {
      .card {
        padding: 12px 2vw 12px 2vw;
        margin-bottom: 18px;
      }
      .card h2 {
        font-size: 1.1rem;
      }
      .card h3 {
        font-size: 1rem;
      }
      th, td {
        padding: 7px 2px;
        font-size: 0.95rem;
      }
      .container {
        padding: 0;
      }
      .header-center h1 {
        font-size: 2rem;
      }
      .header-center p {
        font-size: 1rem;
      }
    }
    @media (max-width: 480px) {
      .card {
        padding: 8px 1vw 8px 1vw;
        border-radius: 10px;
      }
      .card h2, .card h3 {
        font-size: 1rem;
      }
      th, td {
        padding: 5px 1px;
        font-size: 0.9rem;
      }
      .logo-container img {
        height: 60px;
      }
      .header-center h1 {
        font-size: 1.2rem;
      }
      .header-center p {
        font-size: 0.8rem;
      }
      .menu-popup {
        min-width: 120px;
      }
    }
    /* Make tables horizontally scrollable on small screens */
    @media (max-width: 700px) {
      .card table {
        display: block;
        overflow-x: auto;
        width: 100%;
      }
      .card table thead, .card table tbody, .card table tr {
        display: table;
        width: 100%;
        table-layout: fixed;
      }
    }
    /* Section spacing */
    .section {
      margin-bottom: 28px;
    }
    @media (max-width: 900px) {
      header {
        padding: 10px;
      }
      .logo-container img {
        height: 80px;
      }
      .header-center h1 {
        font-size: 2.2rem;
      }
      .header-center p {
        font-size: 1.1rem;
      }
    }
    @media (max-width: 700px) {
      header {
        flex-direction: column;
        align-items: flex-start;
        padding: 8px 2vw;
      }
      .logo-container img {
        height: 60px;
      }
      .header-center h1 {
        font-size: 1.3rem;
      }
      .header-center p {
        font-size: 0.9rem;
      }
      .header-icons {
        flex-direction: row;
        gap: 10px;
        margin-top: 8px;
      }
      .menu-popup {
        min-width: 120px;
        right: 10px;
        top: 60px;
      }
    }
    @media (max-width: 480px) {
      header {
        padding: 4px 1vw;
      }
      .logo-container img {
        height: 40px;
      }
      .header-center h1 {
        font-size: 1rem;
      }
      .header-center p {
        font-size: 0.7rem;
      }
      .menu-popup {
        min-width: 90px;
        right: 4px;
        top: 44px;
      }
    }
  </style>
</head>
<body>

<header>
  <div class="logo-container">
    <a href="admin.html"><img src="logo.png" alt="AudioWerks Logo, click to go home" /></a>
  </div>
  <div class="header-center">
    <h1>Audiowerks</h1>
    <p>Lights and Sounds</p>
  </div>
  <div class="header-icons">
    <i class="fas fa-bars" aria-label="Menu" tabindex="0" onclick="toggleMenu(this)"></i>
  </div>
  <nav class="menu-popup" id="menuPopup" aria-label="Admin Navigation">
    <a href="admin.html">Dashboard</a>
    <a href="#chat">Chat</a>
    <a href="provider.html">Profile</a>
    <a href="login.html" onclick="logout()">Logout</a>
  </nav>
</header>

<div class="container">
  <div class="card">
    <h2 style="margin-bottom: 20px;">Provider Profile Management</h2>
    <!-- Only keep Portfolio section here -->
    <div class="section">
      <h3>Portfolio</h3>
      <label for="portfolioUpload">Upload Image/Video:</label>
      <input type="file" id="portfolioUpload" multiple />
      <button onclick="savePortfolio()">Save Portfolio</button>
      <div class="success" id="portfolioSuccess"></div>
    </div>
  </div>
  <!-- Services and Bundles cards are already styled -->
</div>

<div class="card">
  <h3>Services</h3>
  <table>
    <thead>
      <tr>
        <th>Service</th>
        <th>Price</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="servicesTbody"></tbody>
  </table>
  <div id="addServiceForm" style="margin-top:10px;">
    <input type="text" id="serviceName" placeholder="Service name" style="margin-right:5px;"/>
    <input type="number" id="servicePrice" placeholder="Service price" style="margin-right:5px; width:100px;"/>
    <button id="addServiceBtn">Add Service</button>
  </div>
</div>
<div class="card">
  <h3>Bundles</h3>
  <table>
    <thead>
      <tr>
        <th>Bundle Name</th>
        <th>Price</th>
        <th>Included Services</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="bundlesTbody"></tbody>
  </table>
  <div id="addBundleForm" style="margin-top:10px;">
    <input type="text" id="bundleName" placeholder="Bundle name" style="margin-right:5px;"/>
    <input type="number" id="bundlePrice" placeholder="Bundle price" style="margin-right:5px; width:100px;"/>
    <input type="text" id="bundleServicesInput" placeholder="Included services (comma separated)" style="margin-right:5px; width:220px;"/>
    <button id="addBundleBtn">Add Bundle</button>
  </div>
</div>

<footer>
  <p>&copy; 2025 AudioWerks. All rights reserved.</p>
</footer>

<script>
  function toggleMenu(btn) {
    const menu = document.getElementById('menuPopup');
    const bars = document.querySelector('.fa-bars');
    menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
    bars.classList.toggle('active');
  }
  window.addEventListener('click', function (e) {
    const menu = document.getElementById('menuPopup');
    const button = document.querySelector('.fa-bars');
    if (!menu.contains(e.target) && e.target !== button) {
      menu.style.display = 'none';
      button.classList.remove('active');
    }
  });
  function logout() {
    alert("Logged out.");
  }

  function saveService() {
    const name = document.getElementById('serviceName').value;
    const price = document.getElementById('servicePrice').value;
    if (name && price) {
      // Simulate saving
      document.getElementById('serviceSuccess').textContent = "Service information updated successfully!";
    }
  }

  function saveEquipment() {
    const equipment = document.getElementById('equipmentList').value;
    if (equipment) {
      // Simulate saving
      document.getElementById('equipmentSuccess').textContent = "Equipment list updated successfully!";
    }
  }

  function savePortfolio() {
    const files = document.getElementById('portfolioUpload').files;
    if (files.length > 0) {
      document.getElementById('portfolioSuccess').textContent = "Portfolio updated successfully!";
    }
  }
</script>
<!-- Place these scripts before any custom JS -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script src="firebase-config-new.js"></script>
<script src="firebase-backend-new.js"></script>
<script>
// Services logic
async function loadServices() {
  const services = await window.getAllServices() || {};
  const servicesTbody = document.getElementById('servicesTbody');
  servicesTbody.innerHTML = '';
  Object.entries(services).forEach(([id, s]) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${s.name || ''}</td><td>₱${s.price || ''}</td><td><button class="edit-service" data-id="${id}">Edit</button> <button class="del-service" data-id="${id}">Delete</button></td>`;
    servicesTbody.appendChild(tr);
  });
}
// Bundles logic
async function loadBundles() {
  const bundles = await window.getAllBundles() || {};
  const services = await window.getAllServices() || {};
  // Populate bundles table
  const bundlesTbody = document.getElementById('bundlesTbody');
  bundlesTbody.innerHTML = '';
  Object.entries(bundles).forEach(([id, b]) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${b.name || ''}</td><td>₱${b.price || ''}</td><td>${(b.services||[]).join(', ')}</td><td><button class="edit-bundle" data-id="${id}">Edit</button> <button class="del-bundle" data-id="${id}">Delete</button></td>`;
    bundlesTbody.appendChild(tr);
  });
  // Populate services checkboxes for bundle creation
  const bundleServicesSelect = document.getElementById('bundleServicesSelect');
  bundleServicesSelect.innerHTML = '';
  Object.values(services).forEach(s => {
    const label = document.createElement('label');
    label.style.marginRight = '8px';
    const cb = document.createElement('input');
    cb.type = 'checkbox';
    cb.value = s.name;
    label.appendChild(cb);
    label.appendChild(document.createTextNode(' ' + s.name));
    bundleServicesSelect.appendChild(label);
  });
}
async function loadAll() {
  await loadServices();
  await loadBundles();
}
document.addEventListener('DOMContentLoaded', loadAll);
document.addEventListener('click', async function(e) {
  // Add service
  if (e.target && e.target.id === 'addServiceBtn') {
    const name = document.getElementById('serviceName').value.trim();
    const price = document.getElementById('servicePrice').value.trim();
    if (!name || !price) return;
    await window.addService({ name, price });
    document.getElementById('serviceName').value = '';
    document.getElementById('servicePrice').value = '';
    loadServices();
    loadBundles();
  }
  // Edit service
  if (e.target && e.target.classList.contains('edit-service')) {
    const id = e.target.getAttribute('data-id');
    const services = await window.getAllServices() || {};
    const service = services[id];
    if (!service) return;
    const newName = prompt('Edit service name:', service.name);
    if (newName === null) return;
    const newPrice = prompt('Edit service price:', service.price);
    if (newPrice === null) return;
    if (newName && newPrice) {
      await window.updateService(id, { name: newName, price: newPrice });
      loadServices();
      loadBundles();
    }
  }
  // Delete service
  if (e.target && e.target.classList.contains('del-service')) {
    const id = e.target.getAttribute('data-id');
    if (confirm('Delete this service?')) {
      await window.deleteService(id);
      loadServices();
      loadBundles();
    }
  }
  // Add bundle
  if (e.target && e.target.id === 'addBundleBtn') {
    const name = document.getElementById('bundleName').value.trim();
    const price = document.getElementById('bundlePrice').value.trim();
    const servicesInput = document.getElementById('bundleServicesInput').value.trim();
    const services = servicesInput ? servicesInput.split(',').map(s => s.trim()).filter(Boolean) : [];
    console.log('Add Bundle button clicked!');
    console.log('Bundle name:', name);
    console.log('Bundle price:', price);
    console.log('Included services:', services);
    if (!name || !price || !services.length) {
      alert('Please enter a bundle name, price, and at least one included service.');
      return;
    }
    await window.addBundle({ name, price, services });
    document.getElementById('bundleName').value = '';
    document.getElementById('bundlePrice').value = '';
    document.getElementById('bundleServicesInput').value = '';
    loadBundles();
  }
  // Edit bundle
  if (e.target && e.target.classList.contains('edit-bundle')) {
    const id = e.target.getAttribute('data-id');
    const bundles = await window.getAllBundles() || {};
    const bundle = bundles[id];
    if (!bundle) return;
    const newName = prompt('Edit bundle name:', bundle.name);
    if (newName === null) return;
    const newPrice = prompt('Edit bundle price:', bundle.price);
    if (newPrice === null) return;
    // For services, simple prompt for comma-separated list
    const newServices = prompt('Edit included services (comma separated):', (bundle.services||[]).join(', '));
    if (newName && newPrice && newServices) {
      await window.updateBundle(id, { name: newName, price: newPrice, services: newServices.split(',').map(s => s.trim()).filter(Boolean) });
      loadBundles();
    }
  }
  // Delete bundle
  if (e.target && e.target.classList.contains('del-bundle')) {
    const id = e.target.getAttribute('data-id');
    if (confirm('Delete this bundle?')) {
      await window.deleteBundle(id);
      loadBundles();
    }
  }
});
</script>

</body>
</html>
